import gspread
from oauth2client.service_account import ServiceAccountCredentials

# Rutas y configuración
SCOPE = ["https://spreadsheets.google.com/feeds", "https://www.googleapis.com/auth/drive"]
CREDS_FILE = "credentials.json"  # Asegúrate de que este archivo esté en la misma carpeta
SPREADSHEET_NAME = "WMS SIT"     # Nombre exacto de tu hoja de cálculo

# Conexión
try:
    creds = ServiceAccountCredentials.from_json_keyfile_name(CREDS_FILE, SCOPE)
    client = gspread.authorize(creds)
    sheet = client.open(SPREADSHEET_NAME).worksheet("LPNs")  # Hoja de recepción
    print("✅ Conexión exitosa. Primeras filas:")
    for row in sheet.get_all_values()[:5]:
        print(row)
except Exception as e:
    print("❌ Error al conectar:", e)
